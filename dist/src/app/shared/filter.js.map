{"version":3,"sources":["../../../../src/app/shared/filter.ts"],"names":[],"mappings":"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","file":"filter.js","sourceRoot":"","sourcesContent":["export interface FiltersOptions {\n  filterBy?: FilterBy;\n  select?: Select;\n  offset?: Offset;\n  limit?: Limit;\n  orderBy?: OrderBy;\n  search?: Filter;\n  extra?: Extra;\n  total?: Total;\n}\n\nexport class FilterFactory {\n  url: string;\n\n  static getFiltersByUrl(url: string): Filter[] {\n    const regex = /\\?(.*)/g;\n    const regexQueryParams = regex.exec(url);\n\n    if (!regexQueryParams || (regexQueryParams && regexQueryParams.length === 0)) {\n      return [];\n    }\n    const strQueryParams = regexQueryParams[1];\n    if (!strQueryParams) {\n      return [];\n    }\n    const splitQueryParams = strQueryParams.split('&');\n    const extraFilters = [];\n    const filters: Filter[] = [];\n    for (const queryParam of splitQueryParams) {\n      const splitQueryParam = queryParam.split('=');\n      const key = splitQueryParam[0];\n      const value = splitQueryParam[1];\n      const splitValue = value.split(':');\n\n      let filter;\n      switch (key) {\n        case 'filterBy':\n          const strOperator = splitValue[2];\n          const operatorOptions = strOperator && strOperator === 'like' ? OperatorOptions.Like : OperatorOptions.Equals;\n          filter = new FilterBy(splitValue[0], splitValue[1], operatorOptions);\n          break;\n        case 'select':\n          filter = new Select(value);\n          break;\n        case 'offset':\n          filter = new Offset(Number.parseInt(value));\n          break;\n        case 'limit':\n          filter = new Limit(Number.parseInt(value));\n          break;\n        case 'orderBy':\n          const strOrderOption = splitValue[1];\n          const orderByOption = strOrderOption && strOrderOption === 'desc' ? OrderByOptions.Desc : OrderByOptions.Asc;\n          filter = new OrderBy(value, orderByOption);\n          break;\n        case 'search':\n          filter = new Search(value);\n          break;\n        case 'total':\n          filter = new Total(Number.parseInt(value));\n          break;\n        default:\n          extraFilters.push(new Filter(key, value));\n          break;\n      }\n      if (filter) {\n        filters.push(filter);\n      }\n    }\n    if (extraFilters.length > 0) {\n      filters.push(new Extra(extraFilters));\n    }\n    return filters;\n  }\n\n  constructor(url: string) {\n    this.url = url;\n  }\n\n  addFilter(filter: Filter) {\n    if (!this.url) {\n      this.url = '';\n    }\n\n    if (this.url.length > 0) {\n      this.url += '&' + filter.toString();\n    } else {\n      this.url += filter.toString();\n    }\n  }\n\n  generateUrl(filtersOptions: FiltersOptions): string {\n    let strFilters = '';\n\n    for (const key in filtersOptions) {\n      if (!filtersOptions.hasOwnProperty(key)) {\n        continue;\n      }\n\n      const filterOption = (<any>filtersOptions)[key];\n      const strFilterOption = filterOption.toString();\n      if (!strFilterOption) {\n        continue;\n      }\n\n      strFilters += strFilters.length > 0 ? '&' : '?';\n      strFilters += strFilterOption;\n    }\n\n    return this.url + strFilters;\n  }\n}\n\nexport class Filter {\n  private _name: string;\n  private _value: any;\n\n  constructor(name: string, value: string) {\n    this._name = name;\n    this._value = value;\n  }\n\n  get name(): string {\n    return this._name;\n  }\n\n  get value(): any {\n    return this._value;\n  }\n\n  set value(value: any) {\n    this._value = value;\n  }\n\n  toString(): string {\n    if (this._name && this._value) {\n      return this._name + '=' + this._value;\n    }\n    return '';\n  }\n}\n\nexport enum OperatorOptions {\n  Equals,\n  Like\n}\n\nexport class FilterBy extends Filter {\n  attribute: string;\n  operatorOption: OperatorOptions;\n\n  constructor(attribute: string, value: string, operatorOption?: OperatorOptions) {\n    super('filterBy', value);\n    this.attribute = attribute;\n    this.operatorOption = operatorOption !== undefined ? operatorOption : OperatorOptions.Equals;\n  }\n\n  toString(): string {\n    if (this.name && this.value && this.attribute) {\n      let str = this.name + '=' + this.attribute + ':' + this.value;\n      if (this.operatorOption === OperatorOptions.Like) {\n        str += ':like';\n      }\n      return str;\n    }\n    return '';\n  }\n}\n\nexport enum OrderByOptions {\n  Desc,\n  Asc\n}\n\nexport class OrderBy extends Filter {\n  orderByOption: OrderByOptions;\n\n  constructor(attribute: string, orderByOption?: OrderByOptions) {\n    super('orderBy', attribute);\n    this.orderByOption = orderByOption !== undefined ? orderByOption : OrderByOptions.Desc;\n  }\n\n  toString(): string {\n    if (this.name && this.value) {\n      let strOrderByOption = 'desc';\n      if (this.orderByOption === OrderByOptions.Asc) {\n        strOrderByOption = 'asc';\n      }\n      return this.name + '=' + this.value + ':' + strOrderByOption;\n    }\n    return '';\n  }\n}\n\nexport class Select extends Filter {\n\n  constructor(value: string) {\n    super('select', value);\n  }\n}\n\nexport class Search extends Filter {\n\n  constructor(value: string) {\n    super('search', value);\n  }\n}\n\nexport class Limit extends Filter {\n\n  constructor(value: number) {\n    super('limit', value + '');\n  }\n}\n\nexport class Offset extends Filter {\n\n  constructor(value: number) {\n    super('offset', value + '');\n  }\n}\n\nexport class Extra extends Filter {\n\n  filters: Filter[];\n\n  constructor(filters: Filter[]) {\n    super('extra', filters.toString());\n    this.filters = filters;\n  }\n\n  toString() {\n    let str = '';\n    for (const filter of this.filters) {\n      const strFilter = filter.toString();\n      if (strFilter) {\n        str += str.length > 0 ? '&' : '';\n        str += strFilter;\n      }\n    }\n    return str;\n  }\n}\n\nexport class Total extends Filter {\n\n  constructor(value: number) {\n    super('total', value + '');\n  }\n}\n"]}